<div [ngClass]="isChild ? 'child-page' : 'page-container'">
  <div class="page-header">
    <app-header-panel
      title="{{ 'PAGES.CHARGE-POINTS.TITLE' | translate }}"
      [toolTipContent]="'PAGES.CHARGE-POINTS.CHARGE-POINTS-TOOLTIP' | translate"
      [buttonOption]="{
        color: 'blue',
        size: 'large',
        text: getTranslate('PAGES.CHARGE-POINTS.START-CHARGE'),
        icon: sessionIcon,
      }"
      (buttonClicked)="startChargeConfirmation()"
      [showButton]="
        isUserValidForPolicies([policy.ChargePointRemoteStart]) ? true : false
      "
      *ngIf="!isChild && !isScrolled"
      #headerPanel
    >
    </app-header-panel>

    <div
      class="action-bar sticky-action-bar"
      *ngIf="chargePointsResponse?.length > 0 || isSearchActive === true"
    >
      <div class="action-bar-left">
        <label class="title" *ngIf="showActionbarTitle">{{
          'PAGES.CHARGE-POINTS.TITLE' | translate
        }}</label>

        <span class="p-input-icon-left" *ngIf="showActionbarSearch">
          <div class="svgContainer" [innerHTML]="searchIcon"></div>
          <input
            pInputText
            #gb
            [formControl]="searchItem"
            placeholder="{{ 'COMMON.SEARCH-NAME' | translate }}"
            id="input-search"
            class="form-control radius-border search"
          />
        </span>
        <button
          type="button"
          class="p-button p-button-default border-radius transparent small filter-btn"
          [class.selected-filter]="selectedFilter !== null"
          (click)="filterMenu.toggle($event); generateFilterMenuItems()"
          *ngIf="showActionbarFilter"
        >
          <div class="svgContainer" [innerHTML]="filterIcon"></div>
          <ng-container *ngIf="selectedFilter; else defaultFilter">
            {{ 'COMMON.FILTER-PARAM' | translate: { param: selectedFilter } }}
          </ng-container>
          <ng-template #defaultFilter>
            {{ 'COMMON.FILTER' | translate }}
          </ng-template>
        </button>
        <p-menu
          #filterMenu
          [popup]="true"
          [model]="menuItems"
          appendTo="body"
          styleClass="filter-menu"
        ></p-menu>
      </div>
      <div class="action-bar-right">
        <button
          type="button"
          class="p-button p-button-default small me-2"
          [ngClass]="isBox ? 'gray' : 'bordered-white'"
          (click)="getChargePoints(this.page, this.pageSize)"
        >
          <div class="svgContainer" [innerHTML]="refreshIcon"></div>
          <span>{{ 'COMMON.REFRESH' | translate }}</span>
        </button>

      </div>
    </div>
  </div>

  <div class="page-body" #pageBody>
    <app-loader [loaderMessage]="loaderMessage" *ngIf="loading"></app-loader>

    <ng-container *ngIf="chargePointsResponse">
      <ng-container
        *ngIf="chargePointsResponse?.length === 0; else chargePointListing"
      >
        <ng-container *ngIf="isSearchActive === true; else emptyResponse">
          <div class="d-flex flex-column w-100">
            <div class="table-info">
              <div class="svgContainer" [innerHTML]="infoIcon"></div>
              <label [innerHTML]="'PAGES.CHARGE-POINTS.NO-ITEM' | translate">
              </label>
              <ng-container *ngIf="isSearchActive === true">
                <button
                  type="button"
                  class="p-button p-button-rounded p-button-secondary p-button-sm filter-reset"
                  (click)="resetFilter()"
                >
                  {{ 'COMMON.RESET' | translate }}
                </button>
              </ng-container>
            </div>
          </div>
        </ng-container>
        <ng-template #emptyResponse>
          <ng-container *ngIf="!loading">
            <app-info-panel
              [imageUrl]="noChargePointIconGiga"
              [title]="infoPanelTitle"
              [description]="infoPanelDescription"
              [showButton]="
                isUserValidForPolicies([policy.ChargePointCreate])
                  ? true
                  : false
              "
              [showSecondaryButton]="
                isUserValidForPolicies([policy.ChargePointRead]) && isChild
                  ? true
                  : false
              "
              [secondaryButtonOption]="{
                color: 'transparent',
                size: 'xlarge',
                text: getTranslate('COMMON.GO-TO-CONFIGURATION'),
                icon: settingIconBlack
              }"
              (secondaryButtonClicked)="secondaryButtonHandler()"
              *ngIf="!isBox; else infoCard"
            >
            </app-info-panel>

            <ng-template #infoCard>
              <app-info-card
                [title]="getTranslate('PAGES.CHARGE-POINTS.DONT-HAVE')"
                [subtitle]="
                  getTranslate('PAGES.CHARGE-POINTS.ADD-A-CHARGE-POINT')
                "
                [imgSrc]="noChargePointIcon"
                [headerOption]="{
                  text: getTranslate('PAGES.CHARGE-POINTS.CHARGE-POINT')
                }"
                class="w-100 headered-card"
              >
              </app-info-card>
            </ng-template>
          </ng-container>
        </ng-template>
      </ng-container>

      <ng-template #chargePointListing>
        <div class="d-flex flex-column w-100">
          <div class="table-info">
            <div class="svgContainer" [innerHTML]="infoIcon"></div>
            <label
              [innerHTML]="
                'PAGES.CHARGE-POINTS.TOTAL-ITEM'
                  | translate
                    : {
                        param1: totalItemCount,
                        param2: totalPassiveCpCount,
                        param3: totalNotPairedCpCount
                      }
              "
            >
            </label>
            <ng-container *ngIf="isSearchActive === true">
              <button
                type="button"
                class="p-button p-button-rounded p-button-secondary p-button-sm filter-reset"
                (click)="resetFilter()"
              >
                {{ 'COMMON.RESET' | translate }}
              </button>
            </ng-container>
          </div>

          <lib-surge-table
            [data]="chargePointsResponse"
            [columns]="tableColumns"
            [config]="tableConfig"
          >
          </lib-surge-table>
        </div>
      </ng-template>
    </ng-container>
  </div>
</div>

<p-dialog
  [(visible)]="showDialog"
  [modal]="true"
  [style]="{ minWidth: '320px', padding: '20px', minHeight: '130px' }"
  [draggable]="false"
  [resizable]="false"
  *ngIf="showDialog"
>
  <ng-template pTemplate="header">
    <label class="title bold">
      {{ selectedChargePoint?.name }}
      {{ 'PAGES.CHARGE-POINTS.CONNECT-IDENTIFIER' | translate }}</label
    >
  </ng-template>

  <ng-template pTemplate="body">
    <div class="d-flex align-items-center">
      <button
        type="button"
        class="p-button p-button-default circle small transparent"
        [ngClass]="{
          'feedback-state': isFeedbackVisible(selectedChargePoint?.identifier)
        }"
        (click)="onClickButton(selectedChargePoint?.identifier)"
        ngxClipboard
        [cbContent]="selectedChargePoint?.identifier"
      >
        <i class="pi pi-copy"></i>
      </button>

      <div class="identifier-container">
        <label class="title" style="min-width: 170px;">{{
          selectedChargePoint?.identifier
        }}</label>
        <small
          class="copy-text"
          *ngIf="isFeedbackVisible(selectedChargePoint?.identifier)"
          >{{ 'PAGES.CHARGE-POINTS.CONNECT-COPY-ID' | translate }}</small
        >
      </div>
    </div>
  </ng-template>
</p-dialog>
